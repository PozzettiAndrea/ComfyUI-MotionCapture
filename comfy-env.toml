# MotionCapture - Environment Configuration
# Run: comfy-env install

# ═══════════════════════════════════════════════════════════════════════════════
# ISOLATED ENVIRONMENT
# ═══════════════════════════════════════════════════════════════════════════════

[mocap]
python = "3.11"  # bpy only supports up to 3.11
cuda_version = "auto"
pytorch_version = "auto"

    [mocap.cuda]
    # CUDA extensions - resolved automatically by comfy-env
    detectron2 = "*"
    lietorch = "*"
    torch-scatter = "*"

    [mocap.packages]
    requirements = [
        # Core dependencies
        "numpy>=1.23.0,<2.0.0",
        "pillow>=9.0.0",
        "opencv-python>=4.8.0",

        # Training/inference frameworks
        "lightning>=2.0.0",
        "hydra-core>=1.3.0",
        "hydra-zen",
        "hydra-colorlog",

        # Vision transformer
        "timm>=0.9.0",

        # Core utilities
        "einops>=0.6.0",
        "rich>=13.0.0",
        "termcolor",
        "joblib>=1.2.0",

        # Computer vision
        "scikit-image>=0.19.0",
        "imageio>=2.34.0",
        "av>=13.0.0",

        # Video processing
        "ffmpeg-python>=0.2.0",

        # 3D vision and body models
        "trimesh>=3.20.0",
        "chumpy-fork",
        "smplx>=0.1.28",
        "pycolmap",

        # BVH file format support
        "bvh>=0.3",

        # 2D pose estimation (ViTPose dependencies)
        "cython_bbox",
        "lapx",

        # Additional utilities
        "setuptools>=68.0",
        "yacs>=0.1.8",

        # Model downloads
        "huggingface-hub>=0.20.0",
        "gdown>=4.7.0",

        # SAM 3D Body specific dependencies
        "roma>=1.3.0",
        "dill>=0.3.6",
        "fvcore>=0.1.5",
        "transformers>=4.30.0",
        "braceexpand",
        "webdataset>=0.2.0",
        "loguru>=0.7.0",
        "optree>=0.9.0",
        "pyrootutils>=1.0.4",
        "iopath>=0.1.7",
        "tabulate",
        "portalocker",

        # Blender Python module (headless) - replaces full Blender binary installation
        "bpy==4.2",

        # 3D viewers for FBX preview
        "comfy-3d-viewers>=0.1.0",
    ]

    [mocap.packages.linux]
    requirements = ["pyrender>=0.1.45"]

    [mocap.packages.darwin]
    requirements = []

    [mocap.packages.windows]
    requirements = []

# ═══════════════════════════════════════════════════════════════════════════════
# NODE DEPENDENCIES
# ═══════════════════════════════════════════════════════════════════════════════
# Other ComfyUI custom nodes required by workflows (if any)

[node_reqs]
ComfyUI-VideoHelperSuite = "Kosinkadink/ComfyUI-VideoHelperSuite"
ComfyUI-DepthAnythingV3 = "PozzettiAndrea/ComfyUI-DepthAnythingV3"